<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>AALAM SOS SENDER</title>
    <style>
        body { background: #000; color: #fff; font-family: sans-serif; text-align: center; margin: 0; overflow: hidden; touch-action: manipulation; }
        .header { background: #1a1a1a; padding: 30px 20px; border-bottom: 2px solid #333; }
        .sos-container { height: 50vh; display: flex; align-items: center; justify-content: center; position: relative; }
        .sos-btn {
            width: 200px; height: 200px; background: radial-gradient(#e53935, #8e0000);
            border-radius: 50%; display: flex; align-items: center; justify-content: center;
            font-size: 40px; font-weight: bold; border: none; color: white;
            box-shadow: 0 0 50px rgba(255, 0, 0, 0.4); cursor: pointer;
            z-index: 10;
        }
        svg { position: absolute; transform: rotate(-90deg); pointer-events: none; }
        circle { fill: none; stroke: #ff0000; stroke-width: 8; stroke-dasharray: 628; stroke-dashoffset: 628; }
        #accuracy-info { font-size: 12px; color: #888; margin-top: 15px; }
    </style>
</head>
<body>
    <div class="header">
        <h2 style="letter-spacing: 2px; margin: 5px 0; color: red;">üõ°Ô∏è AALAM SECURITY</h2>
    </div>

    <div class="sos-container">
        <svg width="240" height="240"><circle id="progress-ring" cx="120" cy="120" r="100"></circle></svg>
        <button class="sos-btn" id="sos-trigger">SOS</button>
    </div>

    <p id="status" style="color: #ff3e3e; font-weight: bold;">HOLD FOR 3 SECONDS</p>

    <script>
        const TELEGRAM_TOKEN = '8214991980:AAF7B8fUkyOULoXf0ySrwX6zbPQBz3qpJvo';
        const CHAT_ID = '909942121';
        let timer, progress = 0;
        const btn = document.getElementById('sos-trigger');
        const ring = document.getElementById('progress-ring');

        function startHold(e) {
            e.preventDefault();
            timer = setInterval(() => {
                progress += 2;
                ring.style.strokeDashoffset = 628 - (628 * progress / 100);
                if (progress >= 100) { clearInterval(timer); sendSOS(); resetProgress(); }
            }, 60);
        }

        function resetProgress() { clearInterval(timer); progress = 0; ring.style.strokeDashoffset = 628; }

        function sendSOS() {
            document.getElementById('status').innerText = "üì° SENDING...";
            navigator.geolocation.getCurrentPosition((pos) => {
                const lat = pos.coords.latitude;
                const lng = pos.coords.longitude;
                // HIGHLIGHT: Formatting message exactly like your test sample
                const message = `üö® AALAM SOS ALERT üö®\n\nCode: 0{${lat}},${lng}\nAccuracy: ${Math.round(pos.coords.accuracy)}m`;

                fetch(`https://api.telegram.org/bot${TELEGRAM_TOKEN}/sendMessage?chat_id=${CHAT_ID}&text=${encodeURIComponent(message)}`)  
                .then(() => {
                    document.getElementById('status').innerText = "‚úÖ ALERT SENT";
                    setTimeout(() => { document.getElementById('status').innerText = "HOLD FOR 3 SECONDS"; }, 3000);
                });
            }, (err) => alert(err.message), { enableHighAccuracy: true });
        }

        btn.addEventListener('mousedown', startHold);
        btn.addEventListener('touchstart', startHold);
        window.addEventListener('mouseup', resetProgress);
        window.addEventListener('touchend', resetProgress);
    </script>
</body>
</html>
